## Словари
<br>  

***Задание 1***  
Перед вами данные о картинах и их авторах.

| Название картины         | Автор            |
|--------------------------|------------------|
| Крик                     | Мунк Эдвард      |
| Неизвестная              | Крамской Иван    |
| Итальянский полдень      | Брюллов Карл     |
| Рожь                     | Шишкин Иван      |
| Звёздная ночь            | Ван Гог Винсент  |

Сохраните эти данные в виде словаря, где ключами словаря станут названия картин, а значениями — их авторы. Сохраните словарь в переменной ```arts_dict```.
```
arts_dict ={
    'Крик':'Мунк Эдвард',
    'Неизвестная':'Крамской Иван',
    'Итальянский полдень':'Брюллов Карл',
    'Рожь':'Шишкин Иван',
    'Звёздная ночь':'Ван Гог Винсент',
}

print(arts_dict)
-

{'Крик': 'Мунк Эдвард', 'Неизвестная': 'Крамской Иван', 'Итальянский полдень': 'Брюллов Карл', 'Рожь': 'Шишкин Иван', 'Звёздная ночь': 'Ван Гог Винсент'}
```
<br>  

***Задание 2***  
Добавьте в словарь ещё одну картину. Автор — Айвазовский Иван, название — «Девятый вал».
```
arts_dict = {
    'Звёздная ночь': 'Ван Гог Винсент',
    'Крик': 'Мунк Эдвард',
    'Неизвестная': 'Крамской Иван',
    'Итальянский полдень': 'Брюллов Карл',
    'Рожь': 'Шишкин Иван'
}

arts_dict['Девятый вал'] = 'Айвазовский Иван'

print(arts_dict)
-

{'Звёздная ночь': 'Ван Гог Винсент', 'Крик': 'Мунк Эдвард', 'Неизвестная': 'Крамской Иван', 'Итальянский полдень': 'Брюллов Карл', 'Рожь': 'Шишкин Иван', 'Девятый вал': 'Айвазовский Иван'}
```
<br>  

***Задание 3***  
Напишите функцию ```art_check```, которая проверяет, есть ли картина в словаре. Если картина есть, то функция выводит на экран сообщение: ```'Такая картина есть! Автор: {имя автора}'```, в ином случае функция выводит сообщение: ```'К сожалению, такой картины не нашлось.'```.  
Например, для картины Девятый вал функция вернёт сообщение: ```'Такая картина есть! Автор: Айвазовский Иван'.```
```
# создаем словарь
arts_dict = {               
        'Звёздная ночь': 'Ван Гог Винсент',
        'Крик': 'Мунк Эдвард',
        'Неизвестная': 'Крамской Иван',
        'Итальянский полдень': 'Брюллов Карл',
        'Рожь': 'Шишкин Иван',
        'Девятый вал': 'Айвазовский Иван'
    }

# цикл для перебора ключей .keys() в словаре
def art_check(art):
    for paint in arts_dict.keys():
        if arts_dict.get(art) != None: # если не вернет none значит картина есть
            print(f'Такая картина есть! Автор: {arts_dict[art]}')
        elif arts_dict.get(art) == None: # если вернет none значит картины нет
             print('К сожалению, такой картины не нашлось.')
        break               
    
art_check('Девятый вал')
art_check('Рожь')
art_check('Среди волн')
-

Такая картина есть! Автор: Айвазовский Иван
Такая картина есть! Автор: Шишкин Иван
К сожалению, такой картины не нашлось.
```
<br>  

***Задание 4***  
Немного изменим словарь ```arts_dict```. Теперь для каждой картины есть информация об авторе и о годе создания. Найдите самую старую картину в словаре. Выведите название картины и год создания.
```
arts_dict = {
    'Звёздная ночь': {
        'authour': 'Ван Гог Винсент',
        'year': 1889
    },
    'Крик': {
        'authour': 'Мунк Эдвард',
        'year': 1910
    },
    'Неизвестная': {
        'authour': 'Крамской Иван',
        'year': 1883
    },
    'Итальянский полдень': {
        'authour': 'Брюллов Карл',
        'year': 1827
    },
    'Рожь': {
        'authour': 'Шишкин Иван',
        'year': 1878
    },
    'Девятый вал': {
        'authour': 'Айвазовский Иван',
        'year': 1850
    }
}

year = 2024
oldest_art = str()

for painting, details in arts_dict.items():
    if details['year'] < year:
        year = details['year']
        oldest_art = painting

print(oldest_art, year)
-

Итальянский полдень 1827
```
## Заполнение датафрейма
<br>  

***Задание 1***  
Создайте датафрейм и сохраните его в переменной ```df```.  
```
import pandas as pd

df = pd.DataFrame()
```
<br>  

***Задание 2***  
Снова создайте датафрейм без содержимого, но теперь с двумя колонками: имя и год рождения.  
```
import pandas as pd

df = pd.DataFrame(columns = ['имя', 'год рождения'])
print(df)
-

Empty DataFrame
Columns: [имя, год рождения]
Index: []
```
<br>  

***Задание 3***  
Сохраните значения ```names```, ```years``` в колонках датафрейма. Выведите датафрейм.
```
import pandas as pd

names = ['Вася', 'Петя', 'Таня', 'Маша']
years = [1996, 2001, 1998, 1997]
dat = {
    'имя':names,
    'год рождения':years
}

df = pd.DataFrame(dat)

print(df)
-

|    имя |год рождения|
|--------|------------|
|0  Вася |        1996|
|1  Петя |        2001|
|2  Таня |        1998|
|3  Маша |        1997|
```
<br>  

***Задание 4***  
Представьте данные из таблицы в виде словаря. На основе словаря создайте датафрейм.  

|    имя |год рождения|
|--------|------------|
|0  Вася |        1996|
|1  Петя |        2001|
|2  Таня |        1998|
|3  Маша |        1997|

```
import pandas as pd

data = {
        'имя':['Вася', 'Петя', 'Таня', 'Маша'],
        'год рождения':[1996, 2001, 1998, 1997]
        }
df = pd.DataFrame(data)

print(df)
-

|    имя |год рождения|
|--------|------------|
|0  Вася |        1996|
|1  Петя |        2001|
|2  Таня |        1998|
|3  Маша |        1997|
```
<br>  

***Задание 5***  
Представьте те же самые данные в виде вложенного списка. На основе списка создайте датафрейм.  
```
import pandas as pd

data = [['Вася', '1996'], # Заполните data данными
        ['Петя', '2001'],
        ['Таня', '1998'],
        ['Маша', '1997']]
df = pd.DataFrame(data = data, columns = ['имя', 'год рождения'])

print(df)
-

|    имя |год рождения|
|--------|------------|
|0  Вася |        1996|
|1  Петя |        2001|
|2  Таня |        1998|
|3  Маша |        1997|
```
<br>  

***Задание 6***  
Заполните датафрейм данными из таблицы любым удобным способом. Выведите датафрейм.
```
import pandas as pd

col = {
    'product_id':['#0001', '#0024', '#0201', '#0142', '#0032'],
    'product_name':['Подушка', 'Сковородка', 'Телевизор', 'Наушники', 'Телефон'],
    'company_name':['Idea', 'Tofal', 'Samfung', 'Sonya', 'Pineapple'],
    'price':[790, 1890, 52900, 33400, 96990]
}

df = pd.DataFrame(data = col)

print(df)
-

| product_id | product_name        | company_name     | price |
|------------|---------------------|------------------|-------|
| #0001      | Подушка             | Idea             | 790   |
| #0024      | Сковородка          | Tofal            | 1890  |
| #0201      | Телевизор           | Samfung          | 52900 |
| #0142      | Наушники            | Sonya            | 33400 |
| #0032      | Телефон             | Pineapple        | 96990 |
```
## Выгрузка датафрейма из файла
<br>  

***Задание 1***  
Выгрузите данные из файла ```orders_shop_items.csv``` и сохраните результат в переменной ```df```. Выведите содержимое датафрейма. Файл лежит в директории ```datasets```. Путь к файлу:```/datasets/orders_shop_items.csv```.  
```
import pandas as pd

df = pd.read_csv('/datasets/orders_shop_items.csv')

print(df)
```
<br>  

***Задание 2***  
Выведите первые десять строчек датафрейма ```df```. Для вывода используйте функцию ```print()```.
```
import pandas as pd

df = pd.read_csv('/datasets/orders_shop_items.csv')

print(df.head(10))
```
<br>  

***Задание 3***  
Выведите последние десять строчек датафрейма ```df```. Для вывода используйте функцию ```print()```.
```
import pandas as pd

df = pd.read_csv('/datasets/orders_shop_items.csv')

print(df.tail(10))
```
<br>  

***Задание 4***  
Выведите случайную строку из датафрейма ```df```. Для вывода используйте функцию ```print()```.
```
import pandas as pd

df = pd.read_csv('/datasets/orders_shop_items.csv')

print(df.sample()) 
```
<br>  

***Задание 5***  
Выведите количество строк в датафрейме.  
```
import pandas as pd

df = pd.read_csv('/datasets/orders_shop_items.csv')

print(df.shape[0])
```
<br>  

***Задание 6***  
Выгрузите данные из файла ```imdb_reviews.tsv```. Выведите информацию о данных в датафрейме и занимаемом ими размере. Файл находится в той же директории ```datasets```.
```
import pandas as pd

df = pd.read_csv('/datasets/imdb_reviews.tsv', sep='\t')

print(df.info())
```
## Фильтрация по столбцам
<br>  

***Задание 1***  
Загрузите датасет в переменную ```orders``` и выведите первые пять строк на экран для ознакомления. Сопоставьте содержимое данных с их описанием.
```
# импортируем библиотеку
import pandas as pd

# читаем csv 
orders = pd.read_csv('/datasets/orders_shop_rel.csv')

# выводим первые 5 строк датафрейма
print(orders.head())
```
<br>  

***Задание 2***  
Датафрейм orders содержит столбец ```Unnamed: 0```, который дублирует значения индекса. Такое может происходить при экспорте данных из pandas в форматы ```.csv``` или ```.xslx``` (формат Excel). Этот столбец не пригодится в дальнейшем, поэтому давайте удалим его и сохраним изменения в текущем датафрейме. Для удаления используйте метод ```.drop()```.  
Проверьте результат — после удаления с помощью метода ```head()``` выведите первые три строки на экран.  
```
# импорт библиотеки pandas и загрузка данных датасета orders_shop_rel.csv:
import pandas as pd
orders = pd.read_csv('/datasets/orders_shop_rel.csv')

# удаляем поле 'Unnamed: 0' в исходном датафрейме
orders.drop(columns=['Unnamed: 0'], inplace=True)

print(orders.head(3))
```
<br>  

***Задание 3***  
В прошлом задании вы отлично справились с удалением столбца при помощи метода ```.drop()```. Однако могут быть случаи, когда столбцы, подобные ```Unnamed: 0```,  содержат индекс датасета, который необходимо установить при загрузке. Загрузите датасет с указанием ```Unnamed: 0``` в качестве индекса датафрейма.  
Выведите первые три строки на экран с помощью метода ```head()```.  
```
# импорт библиотеки pandas:
import pandas as pd

# загрузка данных датасета orders_shop_rel.csv с объявлением индекса
orders = pd.read_csv('/datasets/orders_shop_rel.csv', index_col = 'Unnamed: 0')

print(orders.head(3))
```
<br>  

***Задание 4***  
Для актуализации списка клиентов магазина маркетологи просят прислать имя, фамилию и электронную почту каждого клиента. Используя оператор [], создайте срез данных, который будет содержать только столбцы с необходимой информацией. Сохраните результат фильтрации в переменную ```clients``` и выведите первые пять строк для того, чтобы проверить результат фильтрации данных. 
```
# импорт библиотеки pandas и загрузка данных датасета orders_shop_rel.csv:
import pandas as pd
orders = pd.read_csv('/datasets/orders_shop_rel.csv', index_col='Unnamed: 0')

# формируем срез данных из заданных полей
clients = orders[['first_name', 'last_name', 'email']]

print(clients.head())
```
<br>  

***Задание 5***  
Для фильтрации данных можно не только выбирать нужные, но и удалять ненужные столбцы. В одном из предыдущих заданий вы отлично справились с удалением столбца ```'Unnamed: 0'```. В этом задании удалите из датафрейма столбцы ```'total_amt'``` и ```'items_cnt'```, используя метод ```.drop()```. Результат сохраните в исходном датафрейме. В завершение выведите первые пять строк обновлённого датафрейма. 
```
# импорт библиотеки pandas и загрузка данных датасета orders_shop_rel.csv:
import pandas as pd
orders = pd.read_csv('/datasets/orders_shop_rel.csv', index_col='Unnamed: 0')

# удалим избыточные столбцы:
orders.drop(columns = ['total_amt', 'items_cnt'], inplace = True)

print(orders.head())
```
## Фильтрация по строкам при помощи индексации
<br>  

***Задание 1***  
Нужно составить рейтинг клиентов по количеству совершённых заказов. Для этого проведите фильтрацию данных по общему количеству заказанных товаров — отсортируйте  столбец ```'items_cnt'``` в порядке убывания значений. Сохраните результат в переменной result и затем оставьте в новом датафрейме только первые 7 строк, используя оператор ```[]```.
```
# Импорт библиотеки pandas и загрузка данных датасета orders_shop_rel.csv:
import pandas as pd
orders = pd.read_csv('/datasets/orders_shop_rel.csv').drop(columns='Unnamed: 0')

# сортировка по столбцу 'items_cnt' в порядке убывания, срез первые 7 строк 
result = orders.sort_values(by = 'items_cnt', ascending = False)[:7]

print(result)
```
<br>  

***Задание 2***  
Маркетинговый отдел решил провести акцию и предложить 50 клиентам, которые совершили большое количество заказов купоны на скидки. При этом для первых десяти клиентов бонусные условия отличаются от остальных. Ваша задача подготовить две выборки данных:  
* top_10 — выборка, которая включает первых десять клиентов по общему количеству заказов;  
* top_40 — выборка, которая включает срез клиентов, занявших 11-50 места по количеству заказов.  

Чтобы сформировать два списка, отсортируйте данные по количеству заказанных товаров — столбец ```'items_cnt'``` в порядке убывания значений. Сохраните результат в отдельной переменной, название переменной задайте сами.   
Затем, используя отсортированные данные и оператор ```[]```, сделайте два среза ```top_10``` и ```top_40```, в которых будут только персональные данные клиентов — столбцы ```'first_name'```, ```'last_name'``` и ```'email'```.  
Для проверки результата выведите на экран с помощью функции ```print()``` последние две строки датафрейма ```top_10``` и первые две строки датафрейма ```top_40```. Так вы убедитесь, что фильтрация прошла корректно и нет пересечения значений между двумя срезами данных.
```
# Импорт библиотеки pandas и загрузка данных датасета orders_shop_rel.csv:
import pandas as pd
orders = pd.read_csv('/datasets/orders_shop_rel.csv').drop(columns='Unnamed: 0')

# формируем топ-10 и топ-40, сортируем по полю 'items_cnt' в порядке убывания и оставляем необходимые по заданию поля
top_10 = orders.sort_values(by = 'items_cnt', ascending = False)[:10][['first_name', 'last_name', 'email']]
top_40 = orders.sort_values(by = 'items_cnt', ascending = False)[10:50][['first_name', 'last_name', 'email']]

# Выведем на экран результат - первые две строки каждого среза данных:
print(top_10.tail(2))
print(top_40.head(2))
```
<br>  

***Задание 3***  
Менеджеры отдела продаж попросили детализировать покупки, совершенные клиентом с почтой ```'Sunita_Tanaka1992@mail.com'```, а это отличная задача для логической индексации! С помощью неё и оператора ```[]``` создайте необходимый срез данных и выведите его на экран, используя ```print()```. Результат отсортируйте по увеличению номера заказа — ```'order_id'```.
```
# Импорт библиотеки pandas и загрузка данных датасета orders_shop_rel.csv:
import pandas as pd
orders = pd.read_csv('/datasets/orders_shop_rel.csv').drop(columns='Unnamed: 0')

# фильтрация поля 'email' по маске 
mask = orders[orders['email'] == 'Sunita_Tanaka1992@mail.com']

# сортировка по 'order_id' в порядке возрастания
result = mask.sort_values(by = 'order_id')

# вывод результата на экран
print(result)
```
<br>  

***Задание 4***  
Для анализа данных поступила ещё одна задача — проанализировать продажи товаров категорий ```gadget``` и ```device``` с высокой стоимостью. К таким товарам относятся:  
* категория ```gadget``` и стоимость выше 100;  
* категория ```device``` и стоимость выше 200;  

Используйте логическую маску и оператор ```[]```, чтобы провести логическую индексацию датафрейма ```orders``` и выбрать все покупки, которые включали товары ```gadget``` и ```device``` с высокой стоимостью. Стоимость товара возьмите из столбца price.  
Результат сохраните в датафрейме ```results``` и выведите первые пять строк этого датафрейма на экран.
```

```
## Фильтрация по строкам при помощи индексации
<br>  

***Задание 1***  
Нужно сос
